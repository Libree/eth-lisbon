FROM caddy:2.6.4-alpine

# ARG COMMIT_SHA
# ARG NODE_ENV
# ARG ENVIRONMENT
# ENV COMMIT_SHA=${COMMIT_SHA}
# ENV NODE_ENV=${NODE_ENV}
# ENV ENVIRONMENT=${ENVIRONMENT}

ARG VITE_REACT_APP_DEPLOY_VERSION
ARG VITE_REACT_APP_DEPLOY_ENVIRONMENT
ARG VITE_REACT_APP_ANALYTICS_KEY
ARG VITE_IPFS_API_KEY
ARG VITE_ETHERSCAN_API_KEY
ARG VITE_INFURA_GOERLI_PROJECT_ID
ARG VITE_INFURA_MAINNET_PROJECT_ID
ARG VITE_INFURA_API_KEY
ARG VITE_WALLET_CONNECT_PROJECT_ID
ARG VITE_ALCHEMY_KEY_POLYGON_MUMBAI
ARG VITE_ALCHEMY_KEY_POLYGON_MAINNET
ARG VITE_ALCHEMY_KEY_MAINNET
ARG VITE_ALCHEMY_KEY_GOERLI
ARG NODE_OPTIONS

ENV VITE_REACT_APP_DEPLOY_VERSION=${VITE_REACT_APP_DEPLOY_VERSION}
ENV VITE_REACT_APP_DEPLOY_ENVIRONMENT=${VITE_REACT_APP_DEPLOY_ENVIRONMENT}
ENV VITE_REACT_APP_ANALYTICS_KEY=${VITE_REACT_APP_ANALYTICS_KEY}
ENV VITE_IPFS_API_KEY=${VITE_IPFS_API_KEY}
ENV VITE_ETHERSCAN_API_KEY=${VITE_ETHERSCAN_API_KEY}
ENV VITE_INFURA_GOERLI_PROJECT_ID=${VITE_INFURA_GOERLI_PROJECT_ID}
ENV VITE_INFURA_MAINNET_PROJECT_ID=${VITE_INFURA_MAINNET_PROJECT_ID}
ENV VITE_INFURA_API_KEY=${VITE_INFURA_API_KEY}
ENV VITE_WALLET_CONNECT_PROJECT_ID=${VITE_WALLET_CONNECT_PROJECT_ID}         
ENV VITE_ALCHEMY_KEY_POLYGON_MUMBAI=${VITE_ALCHEMY_KEY_POLYGON_MUMBAI}
ENV VITE_ALCHEMY_KEY_POLYGON_MAINNET=${VITE_ALCHEMY_KEY_POLYGON_MUMBAI}
ENV VITE_ALCHEMY_KEY_MAINNET=${VITE_ALCHEMY_KEY_MAINNET}
ENV VITE_ALCHEMY_KEY_GOERLI=${VITE_ALCHEMY_KEY_GOERLI}
ENV NODE_OPTIONS=${NODE_OPTIONS}

## Copy Caddyfile to Caddy
COPY caddyfile.webapp.dev /etc/caddy/Caddyfile
## Copy generated static site to Caddy
WORKDIR /website
COPY packages/web-app/dist .
EXPOSE 9080
